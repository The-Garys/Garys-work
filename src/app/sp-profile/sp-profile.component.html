<!-- <app-sv-nav></app-sv-nav> -->
<div class="body">
  <div class="cont">
    <div id="contt" class="cont-ainer" *ngIf="isChatClicked">
      <div class="mesgs">
        <div class="msg__header">
          <div class="msg-cont-img">
            <img
              class="img-usr-msg"
              src="https://www.pavilionweb.com/wp-content/uploads/2017/03/man-300x300.png"
              alt=""
            />
          </div>
          <div class="name__container">
            <h1 class="name-of-receiver">Ramzi Chammem</h1>
          </div>
          <div class="close-icn">
            <i class="far fa-times-circle" (click)="changeChatClick()"></i>
          </div>
        </div>
        <div class="msg_history" id="msg-hstr">
          <div class="incoming_msg">
            <div class="msg-cnt" *ngFor="let msg of allMsg">
              <div class="incoming_msg" *ngIf="msg.isSp === false">
                <div class="incoming_msg_img">
                  <img
                    src="https://www.pavilionweb.com/wp-content/uploads/2017/03/man-300x300.png"
                    alt="sunil"
                    class="rec-msgs"
                  />
                </div>
                <div class="received_msg">
                  <div class="received_withd_msg">
                    <p>{{ msg.messageBody }}</p>
                    <span class="time_date"> {{ msg.createdAt }}</span>
                  </div>
                </div>
              </div>
              <div class="outgoing_msg" *ngIf="msg.isSp === true">
                <div class="sent_msg">
                  <p>{{ msg.messageBody }}</p>
                  <span class="time_date"> {{ msg.createdAt }}</span>
                </div>
              </div>
            </div>
          </div>
          <div class="type_msg">
            <div class="input_msg_write">
              <input
                type="text"
                class="write_msg"
                placeholder="Type a message"
                [(ngModel)]="message.messageBody"
              />
              <button
                class="msg_send_btn"
                type="button"
                (click)="SendMessage()"
              >
                <i class="fab fa-telegram-plane"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="container" *ngIf="spData">
      <div class="profile-header">
        <div class="profile-image">
          <div class="imgg-cont">
            <img src="{{ spData?.imageUrl }}" alt="" width="200" />
            <div *ngIf="!visitor" class="cam-icon">
              <i (click)="basicModal.show()" class="fas fa-camera"></i>
              <!-- modal -->
              <div class="modalImage"></div>
              <div
                mdbModal
                #basicModal="mdbModal"
                class="modal fade"
                tabindex="-1"
                role="dialog"
                aria-labelledby="myBasicModalLabel"
                aria-hidden="true"
              >
                <div class="modal-dialog" role="document">
                  <div class="modal-content">
                    <div class="modal-header">
                      <button
                        type="button"
                        class="close pull-right"
                        aria-label="Close"
                        (click)="basicModal.hide()"
                      >
                        <span aria-hidden="true">Ã—</span>
                      </button>
                      <!-- <h4 class="modal-title w-100" id="myModalLabel">Modal title</h4> -->
                      <input
                        type="file"
                        (change)="imgUpload($event)"
                        #image
                        alt="Submit"
                      />
                    </div>
                    <!-- <div class="modal-body">
                      ...
                    </div> -->
                    <div class="modal-footer">
                      <button
                        type="button"
                        mdbBtn
                        color="secondary"
                        class="waves-light"
                        aria-label="Close"
                        (click)="basicModal.hide()"
                        mdbWavesEffect
                      >
                        Close
                      </button>
                      <button
                        (click)="updateImage(this.imageUrl)"
                        type="button"
                        mdbBtn
                        color="primary"
                        class="relative waves-light"
                        mdbWavesEffect
                      >
                        Save changes
                      </button>
                    </div>
                  </div>
                </div>
              </div>

              <!-- modal -->
            </div>
          </div>
        </div>
        <div class="profile-nav-info">
          <h3 class="user-name">{{ spData?.fullName }}</h3>
          <div class="adress">
            <p class="state">{{ spData?.location }}</p>
            <br />
          </div>
          <p class="state">{{ spData?.adress }}</p>
        </div>
        <div *ngIf="!visitor" class="profile-option">
          <div class="notification">
            <i class="fa fa-bell"></i>
            <span class="alert-message" (click)="goToAppointments()">{{
              notifications
            }}</span>
          </div>
        </div>
      </div>
      <div class="main-bd">
        <div class="left-side">
          <div class="profile-side">
            <p class="phone-number">
              <i class="fa fa-phone"></i>
              {{ spData?.phoneNumber }}
            </p>
            <p class="email">
              <i class="fa fa-envelope"></i>
              {{ spData?.email }}
            </p>
            <p class="user-profession">
              <i class="fas fa-tools"></i>
              {{ spData?.profession }}
            </p>
            <p class="state">CIN:{{ spData?.CIN }}</p>
            <p class="state" *ngIf="!visitor">
              description:{{ spData?.description }}
            </p>
            <div class="user-bio">
              <h3>Bio:</h3>
              <p class="bio">
                Lorem ipsum, dolor sit amet consectetur adipisicing elit.
                Inventore vero eaque corrupti debitis, ut nobis! Lorem ipsum
                dolor sit amet.
              </p>
            </div>
            <div class="profile-btn">
              <button class="chatbtn" (click)="changeChatClick()">
                <i class="fa fa-comment" (click)="displayChat()"></i>Chat
              </button>
            </div>
            <button
              *ngIf="visitor"
              type="button"
              mdbBtn
              color="primary"
              class="relative waves-light"
              (click)="basicModal.show()"
              mdbWavesEffect
            >
              make appointment
            </button>
            <div
              mdbModal
              #basicModal="mdbModal"
              id="modal"
              class="modal fade"
              tabindex="-1"
              role="dialog"
              aria-labelledby="myBasicModalLabel"
              aria-hidden="true"
            >
              <div class="modal-dialog" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <button
                      type="button"
                      class="close pull-right"
                      aria-label="Close"
                      (click)="basicModal.hide()"
                    ></button>
                  </div>
                  <div class="modal-body">
                    <div class="appointment">
                      <input type="date" class="date" #date />
                      <input
                        type="time"
                        class="time"
                        #time
                        id="appt"
                        name="appt"
                        min="09:00"
                        max="18:00"
                        required
                      />
                      <div class="md-form"></div>
                      <div class="md-form"></div>
                      <div class="md-form"></div>
                    </div>
                  </div>
                  <div class="modal-footer">
                    <button
                      (click)="submit(date.value, time.value)"
                      type="button"
                      mdbBtn
                      color="primary"
                      class="relative waves-light"
                      mdbWavesEffect
                    >
                      Send
                    </button>
                    <button
                      type="button"
                      mdbBtn
                      color="secondary"
                      class="waves-light"
                      aria-label="Close"
                      (click)="basicModal.hide()"
                      mdbWavesEffect
                    >
                      Close
                    </button>
                  </div>
                </div>
              </div>
            </div>
            <div class="user-rating">
              <h3 class="rating">4.5</h3>
              <div class="rate">
                <div class="stars">
                  <i class="fa fa-star"></i><i class="fa fa-star"></i
                  ><i class="fa fa-star"></i><i class="fa fa-star"></i
                  ><i class="fa fa-star"></i>
                </div>
                <span class="no-user"
                  ><span> 123</span>&nbsp;&nbsp; Reviews
                </span>
              </div>
            </div>
          </div>
        </div>
        <div class="right-side">
          <div class="nav">
            <ul>
              <li
                class="user-post active"
                [class.active]="posts"
                (click)="post()"
              >
                Posts
              </li>
              <li
                class="user-review"
                [class.active]="reviews"
                (click)="review()"
              >
                Reviews
              </li>
              <li
                *ngIf="visitor1"
                class="user-setting"
                [class.active]="appointments"
                (click)="goToAppointments()"
              >
                My appointments
              </li>
              <li
                *ngIf="!visitor"
                class="user-review"
                [class.active]="settings"
                (click)="setting()"
              >
                Settings
              </li>
            </ul>
          </div>
          <div class="profile-body">
            <div
              class="profile-posts tab active"
              id="profile-posts"
              *ngIf="posts"
            >
              <div *ngIf="!visitor">
                <h1>Your posts</h1>
                <button
                  class="button button1"
                  type="submit"
                  (click)="displayForm()"
                  *ngIf="!editable"
                >
                  add
                </button>
                <br />

                <div class="post-formm" *ngIf="editable" class="container">
                  <form action="/action_page.php">
                    <input
                      type="file"
                      (change)="imgUpload($event)"
                      #image
                      alt="Submit"
                      width="48"
                      height="48"
                    />
                    <div class="row">
                      <div class="col-25">
                        <label for="fname">Title:</label>
                      </div>
                      <div class="col-75">
                        <input
                          #title
                          type="text"
                          id="fname"
                          name="firstname"
                          placeholder="title.."
                        />
                      </div>
                    </div>

                    <div class="row">
                      <div class="col-25">
                        <label for="subject">Description:</label>
                      </div>
                      <div class="col-75">
                        <textarea
                          #decription
                          id="subject"
                          name="subject"
                          placeholder="Write something.."
                          style="height: 200px"
                        ></textarea>
                      </div>
                    </div>
                    <button
                      class="save-btn"
                      (click)="
                        Add(
                          title.value,
                          decription.value,
                          date.value,
                          spData?._id
                        )
                      "
                    >
                      Save
                    </button>
                  </form>
                </div>
              </div>
              <div class="card-container">
                <mdb-card class="card" *ngFor="let e of spPosts">
                  <div>
                    <span
                      *ngIf="!visitor"
                      (click)="deletePost(e._id)"
                      class="far fa-times-circle circle"
                    ></span>
                    <mdb-card-img
                      src="{{ e.image }}"
                      alt="Card image cap"
                    ></mdb-card-img>
                  </div>
                  <mdb-card-body>
                    <!--Title-->
                    <mdb-card-title>
                      <h4>{{ e.title }}</h4>
                    </mdb-card-title>
                    <!--Text-->
                    <mdb-card-text> {{ e.description }} </mdb-card-text>
                    <h4>{{ e.updatedAt }}</h4>
                  </mdb-card-body>
                </mdb-card>

                <!-- card posts -->
                <!-- service provider posts -->
              </div>
            </div>

            <div
              class="profile-posts tab active"
              id="profile-settings"
              *ngIf="settings"
            >
              <h1>Your settings</h1>
              <!-- settings for the profile -->
              <div class="inputs">
                <!-- first name -->
                <div class="fn-chng">
                  <div class="firstName-lbl">
                    <h3 class="lll">First name:</h3>
                    <br />

                    <label class="firstName-dt">{{ spData?.firstName }}</label>
                    <div
                      class="fn-edit"
                      type="button"
                      (click)="displayInput()"
                      *ngIf="!changable"
                    >
                      <div class="ed">
                        <span class="edit-span">Edit</span>
                        <i class="fas fa-edit"></i>
                      </div>
                    </div>
                  </div>
                  <div class="chngbl-inp">
                    <input
                      [(ngModel)]="firstName"
                      class="fn-inp"
                      type="text"
                      placeholder="firstname"
                      *ngIf="changable"
                    />
                    <button
                      class="fn-save"
                      type="button"
                      (click)="updateFirstName(firstName)"
                      *ngIf="changable"
                    >
                      Save
                    </button>
                  </div>
                </div>
                <!-- last name -->
                <div class="fn-chng">
                  <div class="firstName-lbl">
                    <h3 class="lll">Last name:</h3>
                    <br />
                    <label class="firstName-dt">{{ spData?.lastName }}</label>
                    <div
                      class="fn-edit"
                      type="button"
                      (click)="displayInput1()"
                      *ngIf="!changable1"
                    >
                      <div class="ed">
                        <span class="edit-span">Edit</span>
                        <i class="fas fa-edit"></i>
                      </div>
                    </div>
                  </div>
                  <div class="chngbl-inp">
                    <input
                      [(ngModel)]="lastName"
                      class="fn-inp"
                      type="text"
                      placeholder="lastName"
                      *ngIf="changable1"
                    />
                    <button
                      class="fn-save"
                      type="button"
                      (click)="updateLastName(lastName)"
                      *ngIf="changable1"
                    >
                      Save
                    </button>
                  </div>
                </div>
                <!-- full name -->
                <div>
                  <div class="firstName-lbl">
                    <h3 class="lll">FullName:</h3>
                    <br />
                    <label class="firstName-dt">{{ spData?.fullName }}</label>
                    <div
                      class="fn-edit"
                      type="button"
                      (click)="displayInput2()"
                      *ngIf="!changable2"
                    >
                      <div class="ed">
                        <span class="edit-span">Edit</span>
                        <i class="fas fa-edit"></i>
                      </div>
                    </div>
                  </div>
                  <div class="chngbl-inp">
                    <input
                      [(ngModel)]="fullName"
                      class="fn-inp"
                      type="text"
                      placeholder="fullName"
                      *ngIf="changable2"
                    />
                    <button
                      class="fn-save"
                      type="button"
                      (click)="updateFullName(fullName)"
                      *ngIf="changable2"
                    >
                      Save
                    </button>
                  </div>
                </div>
                <!-- email -->
                <div>
                  <div class="firstName-lbl">
                    <h3 class="lll">Email:</h3>
                    <br />
                    <label class="firstName-dt" id="mail-lbl">{{
                      spData?.email
                    }}</label>
                    <div
                      class="fn-edit"
                      type="button"
                      (click)="displayInput3()"
                      *ngIf="!changable3"
                    >
                      <div class="ed">
                        <span class="edit-span">Edit</span>
                        <i class="fas fa-edit"></i>
                      </div>
                    </div>
                  </div>
                  <div class="chngbl-inp">
                    <input
                      [(ngModel)]="email"
                      class="fn-inp"
                      type="text"
                      placeholder="Email"
                      *ngIf="changable3"
                    />
                    <button
                      class="fn-save"
                      type="button"
                      (click)="updateEmail(email)"
                      *ngIf="changable3"
                    >
                      Save
                    </button>
                  </div>
                </div>
                <!-- adress -->
                <div>
                  <div class="firstName-lbl">
                    <h3 class="lll">Address:</h3>
                    <br />
                    <label class="firstName-dt">{{ spData?.adress }}</label>
                    <div
                      class="fn-edit"
                      type="button"
                      (click)="displayInput4()"
                      *ngIf="!changable4"
                    >
                      <div class="ed">
                        <span class="edit-span">Edit</span>
                        <i class="fas fa-edit"></i>
                      </div>
                    </div>
                  </div>
                  <div class="chngbl-inp">
                    <input
                      [(ngModel)]="adress"
                      class="fn-inp"
                      type="text"
                      placeholder="adress"
                      *ngIf="changable4"
                    />
                    <button
                      class="fn-save"
                      type="button"
                      (click)="updateAdress(adress)"
                      *ngIf="changable4"
                    >
                      Save
                    </button>
                  </div>
                </div>
                <!-- password -->
                <div>
                  <div class="firstName-lbl">
                    <h3 class="lll">Change Password:</h3>
                    <br />
                    <div
                      class="fn-edit"
                      type="button"
                      (click)="displayInput5()"
                      *ngIf="!changable5"
                    >
                      <div class="ed">
                        <span class="edit-span">Edit</span>
                        <i class="fas fa-edit"></i>
                      </div>
                    </div>
                  </div>
                  <div class="chngbl-inp">
                    <input
                      [(ngModel)]="previousPassword"
                      class="fn-inp"
                      type="password"
                      placeholder="enter your previous password"
                      *ngIf="changable5"
                    />
                    <input
                      [(ngModel)]="currentPassword"
                      class="fn-inp"
                      type="password"
                      placeholder="enter your new password"
                      *ngIf="changable5"
                    />
                    <input
                      [(ngModel)]="confirmPassword"
                      class="fn-inp"
                      type="password"
                      placeholder="confirm your password"
                      *ngIf="changable5"
                    />
                    <button
                      class="fn-save"
                      type="button"
                      (click)="
                        updatePassword(
                          previousPassword,
                          currentPassword,
                          confirmPassword
                        )
                      "
                      *ngIf="changable5"
                    >
                      Save
                    </button>
                  </div>
                </div>
              </div>
              <!-- settings for the profile -->
            </div>
            <div
              class="profile-reviews tab"
              id="profile-reviews"
              *ngIf="reviews"
            >
              <app-reviews></app-reviews>
            </div>
            <div
              class="profile-settings tab"
              id="profile-settings"
              *ngIf="appointments"
            >
              <div *ngIf="visitor1">
                <div class="card" *ngFor="let appointment of appointmentsList">
                  <p>you have an appointment on: {{ appointment.date }}</p>
                  <p>at {{ appointment.time }}</p>
                  <h1>By: {{ appointment.userName }}</h1>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
